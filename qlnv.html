<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="qlnv.css">
    <title>Quáº£n LÃ½ NhÃ¢n ViÃªn</title>
    <style>
        
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ‘¤ å¤–å›½äººç®¡ç†</h1>
        
        <div class="controls">
            <button class="btn btn-primary" onclick="loadData()">ğŸ”„ æ›´æ–°</button>
            <button class="btn btn-success" onclick="refreshData()">ğŸ”ƒ LÃ m Má»›i</button>
        </div>
        
        <div id="status" class="status" style="display: none;"></div>
        
        <div class="table-container">
            <table id="employeeTable">
                <thead>
                    <tr>
                        <th>ğŸ†” ç¤¾å“¡ç•ªå·</th>
                        <th>ğŸ‘¤ åå‰</th>
                        <th>âš§ æ€§</th>
                        <th>ä½æ‰€</th>
                        <th>ğŸ‚ èª•ç”Ÿæ—¥</th>
                        <th>ğŸ‚ å…¥ç¤¾</th>
                        <th>ğŸ‚ é€€è·</th>

                    </tr>
                </thead>
                <tbody id="employeeTableBody">
                    <tr>
                        <td colspan="4" class="empty-state">
                            <div>
                                ğŸ“‹<br>
                                <strong>ChÆ°a cÃ³ dá»¯ liá»‡u</strong><br>
                                Nháº¥n "Táº£i Dá»¯ Liá»‡u" Ä‘á»ƒ láº¥y thÃ´ng tin tá»« Google Sheets
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // âš ï¸ THAY Äá»”I API KEY VÃ€ SHEET ID Táº I ÄÃ‚Y
        const API_KEY = 'YOUR_NEW_API_KEY_HERE'; // Thay báº±ng API key má»›i cá»§a báº¡n
        const SHEET_ID = '1NxHPl12h8EEYydRH_BgUQm7krGxzc1UX84n8A6R1di4';
        const RANGE = 'Sheet1!A:AA'; // CÃ³ thá»ƒ thay Ä‘á»•i range theo sheet cá»§a báº¡n
        
        let employeeData = [];
        
        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
            
            if (type === 'success' || type === 'error') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            }
        }
        
        async function loadData() {
            if (API_KEY === 'AIzaSyDxaT4hU_6cIlfhbP2U4EZ1nEJiz7CLBrc') {
                showStatus('âš ï¸ Vui lÃ²ng cáº¥u hÃ¬nh API key trong mÃ£ nguá»“n trÆ°á»›c khi sá»­ dá»¥ng!', 'error');
                return;
            }
            
            showStatus('ğŸ”„ Äang táº£i dá»¯ liá»‡u tá»« Google Sheets...', 'loading');
            
            try {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/1NxHPl12h8EEYydRH_BgUQm7krGxzc1UX84n8A6R1di4/values/Employees!A:AA?key=AIzaSyDxaT4hU_6cIlfhbP2U4EZ1nEJiz7CLBrc`;
                
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (!data.values || data.values.length === 0) {
                    showStatus('ğŸ“­ KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u trong Google Sheets', 'error');
                    return;
                }
                
                employeeData = data.values;
                displayData();
                showStatus(`âœ… ÄÃ£ táº£i thÃ nh cÃ´ng ${employeeData.length - 1} nhÃ¢n viÃªn`, 'success');
                
            } catch (error) {
                console.error('Error loading data:', error);
                showStatus(`âŒ Lá»—i khi táº£i dá»¯ liá»‡u: ${error.message}`, 'error');
            }
        }
        
        function displayData() {
            const tableBody = document.getElementById('employeeTableBody');
            
            if (employeeData.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="empty-state">
                            <div>
                                ğŸ“‹<br>
                                <strong>ChÆ°a cÃ³ dá»¯ liá»‡u</strong><br>
                                Nháº¥n "Táº£i Dá»¯ Liá»‡u" Ä‘á»ƒ láº¥y thÃ´ng tin tá»« Google Sheets
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Skip header row (first row)
            const dataRows = employeeData.slice(1);
            
            if (dataRows.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="empty-state">
                            <div>
                                ğŸ“‹<br>
                                <strong>Chá»‰ cÃ³ tiÃªu Ä‘á», khÃ´ng cÃ³ dá»¯ liá»‡u nhÃ¢n viÃªn</strong>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            const rows = dataRows.map(row => {
                // Äáº£m báº£o cÃ³ Ä‘á»§ 4 cá»™t, thÃªm chuá»—i rá»—ng náº¿u thiáº¿u
                const [id, name, gender, address, birhtday, startwork, endwork] = [
                    row[0] || '',
                    row[1] || '',
                    row[2] || '',
                    row[3] || '',
                    row[4] || '',
                    row[5] || '',
                    row[6] || ''
                ];
                
                return `
                    <tr>
                        <td><strong>${id}</strong></td>
                        <td>${name}</td>
                        <td>${gender}</td>
                        <td>${address}</td>
                        <td>${birhtday}</td>
                        <td>${startwork}</td>
                        <td>${endwork}</td>
                    </tr>
                `;
            }).join('');
            
            tableBody.innerHTML = rows;
        }
        
        // function refreshData() {
        //     employeeData = [];
        //     displayData();
        //     loadData();
        // }
        
        // Tá»± Ä‘á»™ng táº£i dá»¯ liá»‡u khi trang Ä‘Æ°á»£c load (náº¿u Ä‘Ã£ cáº¥u hÃ¬nh API key)
        window.addEventListener('load', () => {
            if (API_KEY !== 'AIzaSyDxaT4hU_6cIlfhbP2U4EZ1nEJiz7CLBrc') {
                loadData();
            }
        });
    </script>
</body>
</html>